
<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta http-equiv="X-UA-Compatible" content="ie=edge"/>
<meta name="theme-color" content="#478079" >



<title></title>
<meta name="description" content="">


<style data-generator="critical-css">

</style>



    
        
        
    

    
        
        
    

    
        
        
    





 


<link
  rel="preload"
  href="/css/bundle.css"
  as="style"
  data-generator="purgeCSS"
  onload="this.onload=null;this.rel='stylesheet'"
  
/>
<noscript>
  <link 
    rel="stylesheet" 
    href="/css/bundle.css"
    
  />
</noscript>



<script src='http://localhost:1313/js/library/lozad.min.js'></script>

 

  </head>

  <body>
    

<header class="header fixed-top rad-animation-group" id="header">
  <div class="container rad-fade-in">
    <nav class="navbar navbar-expand-lg navbar-light p-0">
      <div class="container-fluid">
        <a class="navbar-brand mx-auto" href="http://localhost:1313/">
          <span>Pedro</span>
          <span>Chinen</span>
        </a>
        <button
          class="navbar-toggler collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent, #header"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-lg-auto">
            <li class="nav-item">
              <a class="nav-link active" href="http://localhost:1313/">HOME</a>
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/#about"
                >ABOUT</a
              >
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/#experience"
                >EXPERIENCE</a
              >
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/blog"
                >BLOG</a
              >
            </li>
            
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>


<section id="breadcrumb-bar" class="breadcrumb-bar container">
        <ul class="breadcrumbs">
            <li class="breadcrum-item"><span><a href="/">Home</a></span></li><li class="breadcrum-item"><span><a href="/blog">Blog</a></span></li><li class="breadcrum-item current">Ledger Reports in Emacs</li></ul>
</section>


    <section
      id="blog-single"
      class="section section--border-bottom rad-animation-group"
    >
      <div class="container">
        <h1><a href="/blog/emacs_ledger_reports/">Ledger Reports in Emacs</a></h1>

        <aside id="meta" class="light-border-bottom">
          <div>
            <section>
              Published on
              <h4 id="date">Fri Jan 10, 2025</h4>
            </section>
             
            <ul id="tags">
              
              <li><a href="/tags/emacs/">Emacs</a></li>
              
            </ul>
            
          </div>
        </aside>

        <aside class="content-browser light-border-bottom">
	  Table of Contents:
          <div>
            <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Ledger CLI - Program</a>
</li>
<li><a href="#headline-2">Reports</a>
<ul>
<li><a href="#headline-3">Configuration</a>
</li>
</ul>
</li>
</ul>
</nav>
          </div>
        </aside>

        <div class="row flex-column-reverse flex-md-row rad-fade-down">
          <div class="col-12">
<p>
A ledger is a record-keeping system used to track and manage financial transactions, balances, and accounts. It serves as a central repository of all financial data for an individual, organization, or business. Ledgers are used in accounting to organize and summarize financial information, facilitating the preparation of financial statements.</p>
<p>
Plaintext Accounting (<a href="https://plaintextaccounting.org)">https://plaintextaccounting.org)</a> provides valuable resources on managing financial data using plain text as the primary storage format for transactions.</p>
<p>
With Emacs powerful text editing capabilities this type of data is easy to handle. Additionally, Emacs allows me to integrate this workflow into the same plain-text-based system I use for my notes, creating a unified and consistent approach to organizing information.&#34;</p>
<figure>
<img src="/posts/imgs/ledger_closeup.jpeg" alt="/posts/imgs/ledger_closeup.jpeg" title="/posts/imgs/ledger_closeup.jpeg" width="450px" align="center"/>
<figcaption>
Closeup of a typical pen and peper ledger
</figcaption>
</figure>
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
Ledger CLI - Program
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>
Ledger CLI (<a href="https://ledger-cli.org)">https://ledger-cli.org)</a> is a powerful, double-entry accounting system accessed from the UNIX command-line. Ledger is written by John Wiegley</p>
<p>
Emacs has some functions and configurations to integrate this program in its workflow. With ledger-mode (<a href="https://github.com/ledger/ledger-mode)">https://github.com/ledger/ledger-mode)</a> you can insert transactions and retrieve reports about your finances.</p>
<p>
A Ledger transaction has the following format:</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>2025-01-10   Transaction Identifier
</span></span><span style="display:flex;"><span>    Expenses:Food:Market Y                   $15.00
</span></span><span style="display:flex;"><span>    Expenses:Food:Market X                   $10.00
</span></span><span style="display:flex;"><span>    Assets:Bank:CreditCard</span></span></code></pre></div>
</div>
<p>
In the reports, it is possible to limit how deep an account goes for the report. For example, you may want to know how much was spent in each market. Or the total spent in the food category.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Reports
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p>
To learn more about the reports in ledger (<a href="https://ledger-cli.org/doc/ledger3.html#Run-a-Few-Reports).">https://ledger-cli.org/doc/ledger3.html#Run-a-Few-Reports).</a></p>
<p>
The variable <strong>ledger-reports</strong> saves all reports that can be used by the command <strong>ledger-report</strong>.</p>
<p>
At first, its default reports are:</p>
<ul>
<li>Balance</li>
<li>Register</li>
<li>Register by Payee</li>
<li>Register by Account</li>
</ul>
<p>But those reports does not have a filter for the information and makes reports based on all data in the ledger file. Not the ideal scenario for my problems. So I changed those reports to be:</p>
<ul>
<li>Balance</li>
<li>Balance per Month</li>
<li>Balance Summary per Month</li>
<li>Balance per Year</li>
<li>Balance Summary per Year</li>
<li>Register by Account</li>
</ul>
<p>The difference between <strong>Balance</strong> and <strong>Balance Summary</strong> is necessary because my saved transactions format. As was said before the granularity of the report depends on what you want to see. How much was spent in each place or how much in the category itself.</p>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Configuration
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>
I made some changes to handle years easily. Becauseledger-mode mainly works with month.</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span>  (defun ledger-report-year-format-specifier ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Substitute current year.&#34;</span>
</span></span><span style="display:flex;"><span>    (with-current-buffer (or ledger-report-buffer-name (<span style="color:#a6e22e">current-buffer</span>))
</span></span><span style="display:flex;"><span>      (let* ((month (or ledger-report-current-month (ledger-report--current-month)))
</span></span><span style="display:flex;"><span>             (year (<span style="color:#a6e22e">car</span> month)))
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">format</span> <span style="color:#e6db74">&#34;%s&#34;</span> year))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (setq ledger-report-format-specifiers
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#39;</span>((<span style="color:#e6db74">&#34;ledger-file&#34;</span> <span style="color:#f92672">.</span> ledger-report-ledger-file-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;binary&#34;</span> <span style="color:#f92672">.</span> ledger-report-binary-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;payee&#34;</span> <span style="color:#f92672">.</span> ledger-report-payee-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;account&#34;</span> <span style="color:#f92672">.</span> ledger-report-account-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;month&#34;</span> <span style="color:#f92672">.</span> ledger-report-month-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;tagname&#34;</span> <span style="color:#f92672">.</span> ledger-report-tagname-format-specifier)
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;tagvalue&#34;</span> <span style="color:#f92672">.</span> ledger-report-tagvalue-format-specifier)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">;; My changes to the report format specifiers</span>
</span></span><span style="display:flex;"><span>          (<span style="color:#e6db74">&#34;year&#34;</span> <span style="color:#f92672">.</span> ledger-report-year-format-specifier)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ledger-report-previous-year ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Rebuild report with transactions from the previous month.&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (ledger-report--change-month <span style="color:#ae81ff">-12</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (defun ledger-report-next-year ()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Rebuild report with transactions from the next month.&#34;</span>
</span></span><span style="display:flex;"><span>    (interactive)
</span></span><span style="display:flex;"><span>    (ledger-report--change-month <span style="color:#ae81ff">12</span>))</span></span></code></pre></div>
</div>
<p>
Then I changed the <strong>ledger-reports</strong> variable to have the reports I wanted.</p>
<div class="src src-emacs-lisp">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="display:flex;"><span> (when (featurep <span style="color:#e6db74">&#39;ledger-mode</span>)
</span></span><span style="display:flex;"><span>    (let ((binary <span style="color:#e6db74">&#34;%(binary) -f %(ledger-file) &#34;</span>))
</span></span><span style="display:flex;"><span>      (setq ledger-reports
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">`</span>(
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;bal&#34;</span>            <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;bal&#34;</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;bal month&#34;</span> <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;bal -p %(month) -S amount&#34;</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;bal month summary&#34;</span> <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;bal -p %(month) -S amount --depth 2&#34;</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;bal year&#34;</span>  <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;bal -p %(year) -S amount&#34;</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;bal year summary&#34;</span> <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;bal -p %(year) -S amount --depth 2&#34;</span>))
</span></span><span style="display:flex;"><span>              (<span style="color:#e6db74">&#34;account&#34;</span>        <span style="color:#f92672">,</span>(<span style="color:#a6e22e">concat</span> binary <span style="color:#e6db74">&#34;reg %(account)&#34;</span>))
</span></span><span style="display:flex;"><span>              )
</span></span><span style="display:flex;"><span>            )))</span></span></code></pre></div>
</div>
<p>
Now I can see exactly how much and where I spend my money.</p>
</div>
</div>
</div>
</div>
</div>
        </div>

      </div>
    </section>

    <footer class="footer">
  <div class="container">
    <div class="footer__left">
      <div class="footer__copy">
        © Pedro Chinen. Free Hugo theme by Adrián Moreno Peña.
      </div>
    </div>
    <div class="footer__links">
      <ul class="navbar-nav ">
        <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/">🏠 HOME</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="/#about">ABOUT</a>
        </li>
        
      </ul>
    </div>
    <div class="footer__right">
      
    </div>
  </div>
</footer>
 <script>
  window.addEventListener("load", function() {
    try{
      var observer = window.lozad(".lozad", {
        rootMargin: window.innerHeight / 2 + "px 0px",
        threshold: 0.01
      }); 
      observer.observe();
    } catch(e) {
      console.error(e);
    }
  });
</script>
<script defer src='http://localhost:1313/js/rad-animations.js'></script>
<script defer src='http://localhost:1313/js/library/smooth-scroll.polyfills.min.js'></script>
<script defer src='http://localhost:1313/js/sticky-header.js'></script>
<script defer src='http://localhost:1313/js/smooth-scroll-init.js'></script>
<script defer src='http://localhost:1313/js/library/bootstrap.min.js'></script>

  </body>
</html>

